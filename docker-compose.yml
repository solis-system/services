version: '3.8'
services:
  caddy:
    container_name: caddy
    image: caddy:latest
    restart: always
    networks:
    - proxy-network
    volumes:
    - /var/run/docker.sock:/var/run/docker.sock
    ports:
    - 80:80
    - 443:443
    - 443:443/udp
    - 5000:5000
  homepage:
    container_name: homepage
    image: ghcr.io/gethomepage/homepage:0.9.2
    restart: always
    networks:
    - proxy-network
    volumes:
    - ./config/homepage:/app/config
    - /var/run/docker.sock:/var/run/docker.sock
  hfsql:
    container_name: hfsql
    image: windev/hfsql:FR280085e
    restart: always
    networks:
    - proxy-network
    environment:
    - HFSQL_RANDOM_PASSWORD=${HFSQL_RANDOM_PASSWORD}
    - HFSQL_USER=${HFSQL_USER}
    volumes:
    - hfsql-data:/var/lib/hfsql
    - hfsql_data:/data
    ports:
    - 4900:4900
  solisws_api:
    container_name: solisws_api
    image: ${REGISTRY_URL}/api:latest
    restart: always
    networks:
    - proxy-network
  solisws_pwa:
    container_name: solisws_pwa
    image: ${REGISTRY_URL}/app:latest
    restart: always
    networks:
    - proxy-network
  lolafrance_api:
    container_name: lolafrance_api
    image: ${REGISTRY_URL}/api:latest
    restart: always
    networks:
    - proxy-network
  lolafrance_pwa:
    container_name: lolafrance_pwa
    image: ${REGISTRY_URL}/app:latest
    restart: always
    networks:
    - proxy-network
  redis:
    container_name: redis
    image: redis/redis-stack
    restart: always
    networks:
    - proxy-network
    volumes:
    - redis_data:/data
  mailpit:
    container_name: mailpit
    image: axllent/mailpit
    restart: always
    networks:
    - proxy-network
    environment:
    - TZ=Europe/Paris=${TZ=Europe/Paris}
    volumes:
    - mailpit_data:/data
  mariadb:
    container_name: mariadb
    image: mariadb:11.0.2
    restart: always
    networks:
    - proxy-network
    environment:
    - MARIADB_PASSWORD=${MARIADB_PASSWORD}
    - MARIADB_USER=${MARIADB_USER}
    - MARIADB_ROOT_PASSWORD=${MARIADB_ROOT_PASSWORD}
    volumes:
    - mariadb-data:/var/lib/mysql
  minio:
    container_name: minio
    image: quay.io/minio/minio
    restart: always
    networks:
    - proxy-network
    environment:
    - MINIO_ROOT_USER=${MINIO_ROOT_USER}
    - MINIO_ROOT_PASSWORD=${MINIO_ROOT_PASSWORD}
    volumes:
    - minio_data:/data
    command: server /data --console-address :9090
  registry:
    container_name: registry
    image: registry:latest
    restart: always
    networks:
    - proxy-network
    environment:
    - BASIC_AUTH=${BASIC_AUTH}
    volumes:
    - registry_data:/var/lib/registry
  registry-ui:
    container_name: registry-ui
    image: joxit/docker-registry-ui:latest
    restart: always
    networks:
    - proxy-network
    environment:
    - REGISTRY_TITLE=${REGISTRY_TITLE}
    - NGINX_PROXY_PASS_URL=${NGINX_PROXY_PASS_URL}
    - DELETE_IMAGES=${DELETE_IMAGES}
    - SINGLE_REGISTRY=${SINGLE_REGISTRY}
  webdev-a:
    container_name: webdev-a
    image: windev/webdev:FR280094s
    restart: always
    networks:
    - proxy-network
    environment:
    - NUMERO_DE_SERIE=${NUMERO_DE_SERIE}
    - CLE_D_ACTIVATION=${CLE_D_ACTIVATION}
    - TZ=${TZ}
    volumes:
    - webdev-a_data:/var/lib/WEBDEV/28.0/
    command: --configuration=${NUMERO_DE_SERIE}-${CLE_D_ACTIVATION}
  pma:
    container_name: pma
    image: phpmyadmin:5.2.1-apache
    restart: always
    networks:
    - proxy-network
    depends_on:
    - mariadb
  n8n:
    container_name: n8n
    image: n8nio/n8n:latest
    restart: always
    networks:
    - proxy-network
    volumes:
    - n8n_data:/home/node/.n8n
  uptime:
    container_name: uptime
    image: louislam/uptime-kuma:1.23.8
    restart: always
    networks:
    - proxy-network
    volumes:
    - uptime_data:/app/data
    - /var/run/docker.sock:/var/run/docker.sock
volumes:
  hfsql_data:
    external: true
networks:
  proxy-network:
    external: true
